<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Define Projection</title>

<script src="/webres/packages/OpenLayers/v7.2.2/dist/ol.js"></script>
<script src="/webres/packages/proj4js-2.8.1/dist/proj4.js"></script>

<script type="text/javascript">

var x1 = 127;
var y1 = 37.5;

console.log(x1 + ', ' + y1);

//proj4js
proj4.defs("EPSG:5179","+proj=tmerc +lat_0=38 +lon_0=127.5 +k=0.9996 +x_0=1000000 +y_0=2000000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs +type=crs");
proj4.defs("EPSG:4326","+proj=longlat +datum=WGS84 +no_defs +type=crs");
proj4.defs("EPSG:5186","+proj=tmerc +lat_0=38 +lon_0=127 +k=1 +x_0=200000 +y_0=600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs +type=crs");

var s_srs = new proj4.Proj("EPSG:4326");
var e1_srs = new proj4.Proj("EPSG:5179");
var e2_srs = new proj4.Proj("EPSG:5186");

var pt1 = new proj4.toPoint([x1, y1]); //포인트 생성 
var ChangePt1 = proj4.transform(s_srs, e1_srs, pt1); //좌표계 변경
var ChangePt2 = proj4.transform(e1_srs, e2_srs, ChangePt1); //좌표계 변경
// X, Y 위치가 변경되어 출력됨
console.log(ChangePt1);
console.log(ChangePt2);

//OpenLayers
ol.proj.proj4.register(proj4)
console.log(ol.proj.get("EPSG:5179"));
console.log(ol.proj.get("EPSG:4326"));
console.log(ol.proj.get("EPSG:3857"));

//5179 좌표계 
ChangePt1 = ol.proj.transform([ChangePt2.x, ChangePt2.y], "EPSG:5186", "EPSG:5179"); //좌표계 변경
ChangePt2 = ol.proj.transform(ChangePt1, "EPSG:5179", "EPSG:3857"); //좌표계 변경
ChangePt3 = ol.proj.transform(ChangePt2, "EPSG:3857", "EPSG:4326"); //좌표계 변경
console.log(ChangePt1);
console.log(ChangePt2);
console.log(ChangePt3);

console.log("=========== 검증시작 ===========");

//5174 좌표계 10계수에 대한 7변환계수 검증
//답지: 
//4326: 127.067459827817274 37.548315547040730
//5174: 205891.727727905090433 449563.364341802895069
//결과:
//4326->5174: x: 205902.58373553128, y: 449550.369454871 (2003년 변경 고시한 국가좌표변환계수 : 2003-497호)
//5174->4236: x: 127.06733712545152, y: 37.54843263802783 (2003년 변경 고시한 국가좌표변환계수 : 2003-497호)
//5174->4236: x: 127.06746004853557, y: 37.54831516054724 (2002년 12월 고시)
proj4.defs("EPSG:5174","+proj=tmerc +lat_0=38 +lon_0=127.002890277778 +k=1 +x_0=200000 +y_0=500000 +ellps=bessel +towgs84=-145.907,505.034,685.756,-1.162,2.347,1.592,6.342 +units=m +no_defs +type=crs");
proj4.defs("EPSG:4326","+proj=longlat +datum=WGS84 +no_defs +type=crs");
e1_srs = new proj4.Proj("EPSG:5174");
e2_srs = new proj4.Proj("EPSG:4326");
pt1 = new proj4.toPoint([205891.727727905090433, 449563.364341802895069]); //포인트 생성 
var ChangePt4 = proj4.transform(e1_srs, e2_srs, pt1); //좌표계 변경
var pt2 = new proj4.toPoint([ChangePt4.x, ChangePt4.y]); //포인트 생성
var ChangePt5 = proj4.transform(e2_srs, e1_srs, pt2); //좌표계 변경
console.log(ChangePt4);
//ChangePt4 {x: 127.06733712545152, y: 37.54843263802783}
console.log(ChangePt5);
//ChangePt5 {x: 205891.7318426155, y: 449563.35805277945}
</script>
</head>
<body>

</body>
</html>